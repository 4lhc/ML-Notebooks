
<tex2html_mydb_mark>#1#% Basic figure setup, for now with no caption control since it's done
    
<tex2html_mydb_mark>#2#% Maintain compatibility with old templates. Remove in nbconvert 6.0
    
<tex2html_mydb_mark>#3#% Ensure that by default, figures have no caption (until we provide a
    
<tex2html_mydb_mark>#4#% in the conversion process - todo).
    
<tex2html_mydb_mark>#5#% forces figures to be placed at the correct location
    
<tex2html_mydb_mark>#6#% Hack from http://tex.stackexchange.com/a/47451/13684:
    
<tex2html_mydb_mark>#7#%
        
<tex2html_mydb_mark>#8#% Upright quotes in Pygmentized code
    
<tex2html_mydb_mark>#9#% The hyperref package gives us a pdf with properly built
    
<tex2html_mydb_mark>#10#% internal cross-reference links, web links for URLs, etc.)
    
<tex2html_mydb_mark>#11#% The default LaTeX title has an obnoxious amount of whitespace. By default,
    
<tex2html_mydb_mark>#12#% normalem makes italics be italics, not underlines
    
<tex2html_mydb_mark>#13#% Colors for the hyperref package
    
<tex2html_mydb_mark>#14#% ANSI colors
    
<tex2html_mydb_mark>#15#% commands and environments needed by pandoc snippets
    
<tex2html_mydb_mark>#16#%
      
<tex2html_mydb_mark>#17#% Add ',fontsize=\small' for more characters per line
    
<tex2html_mydb_mark>#18#% Additional commands for more recent versions of Pandoc
    
<tex2html_mydb_mark>#19#% Define a nice break command that doesn't care if a line doesn't already
    
<tex2html_mydb_mark>#20#% Math Jax compatibility definitions
    
<tex2html_mydb_mark>#21#% Document parameters
    
<tex2html_mydb_mark>#22#% Pygments definitions

<tex2html_mydb_mark>#23#%
    
<tex2html_mydb_mark>#24#%
    
<tex2html_mydb_mark>#25#%
    
<tex2html_mydb_mark>#26#%
    
<tex2html_mydb_mark>#27#% for compatibility with earlier versions

<tex2html_mydb_mark>#28#% For linebreaks inside Verbatim environment from package fancyvrb. 
    
<tex2html_mydb_mark>#29#% Take advantage of the already applied Pygments mark-up to insert 
        
<tex2html_mydb_mark>#30#%        {, ;SPMlt;, #, %, $, ' and ;SPMquot;: go to next line. 
        
<tex2html_mydb_mark>#31#% Use of \textquotesingle for straight quote. 
        
<tex2html_mydb_mark>#32#% 
            
<tex2html_mydb_mark>#33#% 
            
<tex2html_mydb_mark>#34#% 
            
<tex2html_mydb_mark>#35#% 
            
<tex2html_mydb_mark>#36#% 
            
<tex2html_mydb_mark>#37#% 
            
<tex2html_mydb_mark>#38#% 
            
<tex2html_mydb_mark>#39#% 
            
<tex2html_mydb_mark>#40#% 
            
<tex2html_mydb_mark>#41#% 
            
<tex2html_mydb_mark>#42#% 
            
<tex2html_mydb_mark>#43#% 
            
<tex2html_mydb_mark>#44#% 
            
<tex2html_mydb_mark>#45#% 
            
<tex2html_mydb_mark>#46#% 
        
<tex2html_mydb_mark>#47#% Some characters . , ; ? ! / are not pygmentized. 
        
<tex2html_mydb_mark>#48#% 
            
<tex2html_mydb_mark>#49#% 
            
<tex2html_mydb_mark>#50#% 
            
<tex2html_mydb_mark>#51#% 
            
<tex2html_mydb_mark>#52#% 
            
<tex2html_mydb_mark>#53#% 
            
<tex2html_mydb_mark>#54#% 
            
<tex2html_mydb_mark>#55#% 
            
<tex2html_mydb_mark>#56#%
        
<tex2html_mydb_mark>#57#%
        
<tex2html_mydb_mark>#58#%
        
<tex2html_mydb_mark>#59#%
        
<tex2html_mydb_mark>#60#%
        
<tex2html_mydb_mark>#61#% space at end of first line, and a continuation symbol starts next line.
        
<tex2html_mydb_mark>#62#%
            
<tex2html_mydb_mark>#63#%
        
<tex2html_mydb_mark>#64#%
        
<tex2html_mydb_mark>#65#% Allow breaks at special characters using \PYG... macros.
        
<tex2html_mydb_mark>#66#% Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        
<tex2html_mydb_mark>#67#%
    
<tex2html_mydb_mark>#68#% Exact colors from NB
    
<tex2html_mydb_mark>#69#% prompt
    
<tex2html_mydb_mark>#70#% Prevent overflowing lines due to hard-to-break entities
    
<tex2html_mydb_mark>#71#% Setup hyperref package
    
<tex2html_mydb_mark>#72#% so long urls are correctly broken across lines
      
<tex2html_mydb_mark>#73#% Slightly bigger margins than the latex defaults
    
<tex2html_mydb_mark>#74#%

<tex2html_mydb_mark>#75#%

<tex2html_mydb_mark>#76#%

<tex2html_mydb_mark>#77#%

<tex2html_mydb_mark>#78#%

<tex2html_mydb_mark>#79#%

<tex2html_mydb_mark>#80#%

<tex2html_mydb_mark>#81#%

<tex2html_mydb_mark>#82#%

<tex2html_mydb_mark>#83#%

<tex2html_mydb_mark>#84#% Add a bibliography block to the postdoc
    
<tex2html_mydb_mark>#85#
Evaluation Metrices
Dataset: Pima Indians Diabetes Database
Author: Sreejith S
<tex2html_mydb_mark>#86#[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt} 
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}

\PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} autoreload
\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\PY{o}{\PYZpc{}}\PY{k}{autoreload} 2
\PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}retina\PYZsq{}
<tex2html_mydb_mark>#87#[commandchars=\\\{\}]
The autoreload extension is already loaded. To reload it, use:
  \%reload\_ext autoreload
<tex2html_mydb_mark>#88#[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}set pd display options}
\PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.max\PYZus{}columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{80}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Importing the dataset}
\PY{n}{dataset} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../datasets/pima\PYZhy{}indians\PYZhy{}diabetes.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
\PY{n+nb}{print}\PY{p}{(}\PY{n}{dataset}\PY{o}{.}\PY{n}{shape}\PY{p}{)}

\PY{c+c1}{\PYZsh{}selecting features}
\PY{n}{f\PYZus{}best} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plasma\PYZus{}glucose}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{serum\PYZus{}insulin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bmi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diab\PYZus{}pedigree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}a} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pregnant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bmi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}b} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{skin\PYZus{}thickness}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diab\PYZus{}pedigree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dia\PYZus{}BP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{f\PYZus{}all} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pregnant}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plasma\PYZus{}glucose}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dia\PYZus{}BP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{skin\PYZus{}thickness}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{serum\PYZus{}insulin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bmi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diab\PYZus{}pedigree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{X} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{f\PYZus{}best}\PY{p}{]}
\PY{n}{X\PYZus{}4\PYZus{}3\PYZus{}a} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}a}\PY{p}{]}
\PY{n}{X\PYZus{}4\PYZus{}3\PYZus{}b} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}b}\PY{p}{]}
\PY{n}{X\PYZus{}all} \PY{o}{=} \PY{n}{dataset}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diab}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{n}{f\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{f\PYZus{}best}\PY{p}{,} \PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}a}\PY{p}{,} \PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}b}\PY{p}{,} \PY{n}{f\PYZus{}all}\PY{p}{]}
\PY{n}{y} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diab}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
<tex2html_mydb_mark>#89#[commandchars=\\\{\}]
(768, 9)
<tex2html_mydb_mark>#90#[commandchars=\\\{\}]
\PY{n}{y}\PY{p}{[}\PY{n}{y} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{/}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
<tex2html_mydb_mark>#91#[commandchars=\\\{\}]
0.3489583333333333
<tex2html_mydb_mark>#92#[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{,} \PY{n}{plot\PYZus{}precision\PYZus{}recall\PYZus{}curve}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{f1\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}score}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{,} \PY{n}{average\PYZus{}precision\PYZus{}score}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{matthews\PYZus{}corrcoef}\PY{p}{,} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score} 
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{ConfusionMatrixDisplay}\PY{p}{,} \PY{n}{precision\PYZus{}recall\PYZus{}curve}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{dummy} \PY{k}{import} \PY{n}{DummyClassifier}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{from} \PY{n+nn}{utils} \PY{k}{import} \PY{n}{plot\PYZus{}table}\PY{p}{,} \PY{n}{plot\PYZus{}confusion}


\PY{n}{short\PYZus{}titles} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DC\PYZhy{}4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LR\PYZhy{}4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LR\PYZhy{}4.3.a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LR\PYZhy{}4.3.b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LR\PYZhy{}all}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{titles} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DummyClf \PYZhy{} plasma\PYZus{}glucose, serum\PYZus{}insulin, bmi, pedigree}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogitReg \PYZhy{} plasma\PYZus{}glucose, serum\PYZus{}insulin, bmi, pedigree}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogitReg \PYZhy{} age, \PYZsh{}preg, bmi}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogitReg \PYZhy{} skin\PYZus{}th, pedigree, B.P}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogitReg \PYZhy{} All features}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{feature\PYZus{}sets} \PY{o}{=} \PY{p}{[}\PY{n}{f\PYZus{}best}\PY{p}{,} \PY{n}{f\PYZus{}best}\PY{p}{,} \PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}a}\PY{p}{,} \PY{n}{f\PYZus{}4\PYZus{}3\PYZus{}b}\PY{p}{,} \PY{n}{f\PYZus{}all}\PY{p}{]}
\PY{n}{y} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diab}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
    
\PY{n}{confusion\PYZus{}matrices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{eval\PYZus{}metrics\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}


\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seaborn\PYZhy{}whitegrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}roc} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{ax\PYZus{}roc}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Receiver Operating Characteristic Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}pre} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{ax\PYZus{}pre}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision\PYZhy{}Recall Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{}Plotting the actual precision and recall on the precision\PYZhy{}recall plot}
\PY{c+c1}{\PYZsh{}These values were obtained from the table}
\PY{n}{ax\PYZus{}pre}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.31}\PY{p}{,} \PY{l+m+mf}{0.55}\PY{p}{,} \PY{l+m+mf}{0.08}\PY{p}{,} \PY{l+m+mf}{0.53}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mf}{0.51}\PY{p}{,} \PY{l+m+mf}{0.75}\PY{p}{,} \PY{l+m+mf}{0.50}\PY{p}{,} \PY{l+m+mf}{0.71}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model precision \PYZam{} recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}roc}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mf}{0.089171}\PY{p}{,} \PY{l+m+mf}{0.554054}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model Best \PYZhy{} LR\PYZhy{}4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}roc}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{l+m+mf}{0.1019}\PY{p}{,} \PY{l+m+mf}{0.5270}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model Best \PYZhy{} LR\PYZhy{}all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}


\PY{n}{ax\PYZus{}table} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{ax\PYZus{}table}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Evaluation Metrices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{feature} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{feature\PYZus{}sets}\PY{p}{)}\PY{p}{:}
        
    \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{clf} \PY{o}{=} \PY{n}{DummyClassifier}\PY{p}{(}\PY{n}{strategy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{most\PYZus{}frequent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{clf} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}
    
    \PY{n}{X} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{feature}\PY{p}{]}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} 
                                                      \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{y\PYZus{}preds} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{y\PYZus{}proba} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
    \PY{c+c1}{\PYZsh{}fpr, tpr, threshold\PYZus{}roc = roc\PYZus{}curve(y\PYZus{}test, y\PYZus{}proba)}
    \PY{c+c1}{\PYZsh{}prec, recall, threshold\PYZus{}pre = precision\PYZus{}recall\PYZus{}curve(y\PYZus{}test, y\PYZus{}proba)}

    
    \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}roc}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}  
    \PY{n}{plot\PYZus{}precision\PYZus{}recall\PYZus{}curve}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}pre}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
    
    \PY{n}{confusion\PYZus{}matrices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{)}
    \PY{n}{eval\PYZus{}metrics} \PY{o}{=} \PY{p}{[}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                    \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{,} \PY{n}{zero\PYZus{}division}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}
                    \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{matthews\PYZus{}corrcoef}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}proba}\PY{p}{)}\PY{p}{,}
                    \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}proba}\PY{p}{)}\PY{p}{]}
    \PY{n}{eval\PYZus{}metrics} \PY{o}{=} \PY{p}{[}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}i:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{eval\PYZus{}metrics}\PY{p}{]}
    \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}In case of DummyClassifier with strategy=most\PYZus{}frequent, precision \PYZam{} mcc are N.D}
        \PY{n}{eval\PYZus{}metrics}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}Replace precision with N.D}
        \PY{n}{eval\PYZus{}metrics}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}Replce MCC}
    \PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{eval\PYZus{}metrics}\PY{p}{)}



\PY{n}{ax\PYZus{}pre}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}table}\PY{p}{(}\PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{p}{,} \PY{n}{ax\PYZus{}table}\PY{p}{,} \PY{n}{short\PYZus{}titles}\PY{p}{)}


\PY{n}{plot\PYZus{}confusion}\PY{p}{(}\PY{n}{confusion\PYZus{}matrices}\PY{p}{,} \PY{n}{short\PYZus{}titles}\PY{p}{)}

\PY{c+c1}{\PYZsh{}fig = plt.figure(figsize=(10, 10))}
\PY{c+c1}{\PYZsh{}plt.hist(y\PYZus{}proba[np.where(y\PYZus{}test==1)], bins=100, density=True, alpha=0.6, color=\PYZsq{}g\PYZsq{})}
\PY{c+c1}{\PYZsh{}plt.hist(y\PYZus{}proba[np.where(y\PYZus{}test==0)], bins=100, density=True, alpha=0.6, color=\PYZsq{}r\PYZsq{})}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
<tex2html_mydb_mark>#93#[commandchars=\\\{\}]
/home/sj/.local/lib/python3.8/site-
packages/sklearn/metrics/\_classification.py:846: RuntimeWarning: invalid value
encountered in double\_scalars
  mcc = cov\_ytyp / np.sqrt(cov\_ytyt * cov\_ypyp)
<tex2html_mydb_mark>#94#[commandchars=\\\{\}]
\PY{n}{y\PYZus{}new} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0} \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1} \PY{k}{else} \PY{l+m+mi}{1} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{y}\PY{p}{]}\PY{p}{)}
\PY{n}{confusion\PYZus{}matrices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{eval\PYZus{}metrics\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}


\PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seaborn\PYZhy{}whitegrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}roc} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{ax\PYZus{}roc}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Receiver Operating Characteristic Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{ax\PYZus{}pre} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{ax\PYZus{}pre}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision\PYZhy{}Recall Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{n}{ax\PYZus{}table} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\PY{n}{ax\PYZus{}table}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Evaluation Metrices}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}


\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{feature} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{feature\PYZus{}sets}\PY{p}{)}\PY{p}{:}
        
    \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{clf} \PY{o}{=} \PY{n}{DummyClassifier}\PY{p}{(}\PY{n}{strategy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{most\PYZus{}frequent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{clf} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}
    
    \PY{n}{X} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{feature}\PY{p}{]}
    \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y\PYZus{}new}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} 
                                                      \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
    \PY{n}{y\PYZus{}preds} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{y\PYZus{}proba} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
    \PY{c+c1}{\PYZsh{}fpr, tpr, threshold\PYZus{}roc = roc\PYZus{}curve(y\PYZus{}test, y\PYZus{}proba)}
    \PY{c+c1}{\PYZsh{}prec, recall, threshold\PYZus{}pre = precision\PYZus{}recall\PYZus{}curve(y\PYZus{}test, y\PYZus{}proba)}

    
    \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}roc}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}  
    \PY{n}{plot\PYZus{}precision\PYZus{}recall\PYZus{}curve}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax\PYZus{}pre}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
    
    \PY{n}{confusion\PYZus{}matrices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{)}
    \PY{n}{eval\PYZus{}metrics} \PY{o}{=} \PY{p}{[}\PY{n}{clf}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,}
                    \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{,} \PY{n}{zero\PYZus{}division}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}
                    \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{matthews\PYZus{}corrcoef}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}preds}\PY{p}{)}\PY{p}{,}
                    \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}proba}\PY{p}{)}\PY{p}{,}
                    \PY{n}{average\PYZus{}precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}proba}\PY{p}{)}\PY{p}{]}
    \PY{n}{eval\PYZus{}metrics} \PY{o}{=} \PY{p}{[}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}i:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{eval\PYZus{}metrics}\PY{p}{]}
    \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}In case of DummyClassifier with strategy=most\PYZus{}frequent, precision \PYZam{} mcc are N.D}
        \PY{n}{eval\PYZus{}metrics}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}Replace precision with N.D}
        \PY{n}{eval\PYZus{}metrics}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}Replce MCC}
    \PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{eval\PYZus{}metrics}\PY{p}{)}



\PY{n}{ax\PYZus{}pre}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plot\PYZus{}table}\PY{p}{(}\PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{p}{,} \PY{n}{ax\PYZus{}table}\PY{p}{,} \PY{n}{short\PYZus{}titles}\PY{p}{)}


\PY{n}{plot\PYZus{}confusion}\PY{p}{(}\PY{n}{confusion\PYZus{}matrices}\PY{p}{,} \PY{n}{short\PYZus{}titles}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
<tex2html_mydb_mark>#95#[commandchars=\\\{\}]
/home/sj/.local/lib/python3.8/site-
packages/sklearn/metrics/\_classification.py:846: RuntimeWarning: invalid value
encountered in double\_scalars
  mcc = cov\_ytyp / np.sqrt(cov\_ytyt * cov\_ypyp)
<tex2html_mydb_mark>#96#[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZpc{}load utils.py}
\PY{c+c1}{\PYZsh{}!/bin/env python3}

\PY{c+c1}{\PYZsh{} Author: Sreejith S}
\PY{c+c1}{\PYZsh{} Date: Sat 26 Sep 2020 15:21:44 IST}
\PY{c+c1}{\PYZsh{}}
\PY{c+c1}{\PYZsh{} Plotting Utilities}


\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{f1\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}score}\PY{p}{,} \PY{n}{recall\PYZus{}score}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{matthews\PYZus{}corrcoef}
\PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}


\PY{k}{def} \PY{n+nf}{plot\PYZus{}table}\PY{p}{(}\PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{p}{,} \PY{n}{ax}\PY{p}{,} \PY{n}{titles}\PY{p}{)}\PY{p}{:}
    \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}axis\PYZus{}off}\PY{p}{(}\PY{p}{)}
    \PY{n}{table} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{table}\PY{p}{(}
      \PY{n}{cellText} \PY{o}{=} \PY{n}{eval\PYZus{}metrics\PYZus{}list}\PY{p}{,}
      \PY{n}{rowLabels} \PY{o}{=} \PY{n}{titles}\PY{p}{,}
      \PY{n}{colLabels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precison}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1 Score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MCC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AUROC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Avg. Precision}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
      \PY{n}{rowColours} \PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{skyblue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{5}\PY{p}{,}
      \PY{n}{colColours} \PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{skyblue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{7}\PY{p}{,}
      \PY{n}{cellLoc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
      \PY{n}{loc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}
    \PY{p}{)}
    \PY{n}{table}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
    \PY{n}{table}\PY{o}{.}\PY{n}{scale}\PY{p}{(}\PY{l+m+mf}{1.1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}ax.text(0.5, 0.45, \PYZdq{}text\PYZdq{}, ha=\PYZdq{}center\PYZdq{} )}

    
\PY{k}{def} \PY{n+nf}{plot\PYZus{}confusion}\PY{p}{(}\PY{n}{cf\PYZus{}matrices}\PY{p}{,} \PY{n}{titles}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Plot multiple cfm side by side:}
\PY{l+s+sd}{    Ref : https://stackoverflow.com/questions/61825227/plotting\PYZhy{}multiple\PYZhy{}confusion\PYZhy{}matrix\PYZhy{}side\PYZhy{}by\PYZhy{}side}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{sharex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{sharey}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}

    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{ax} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{axes}\PY{o}{.}\PY{n}{flat}\PY{p}{)}\PY{p}{:}
        \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{cf\PYZus{}matrices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,}\PY{n}{cbar}\PY{o}{=}\PY{n}{i}\PY{o}{==}\PY{l+m+mi}{4}\PY{p}{,} 
                    \PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{YlGnBu}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}

    \PY{n}{fig}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.45}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ha}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.45}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ha}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,} \PY{n}{rotation\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{anchor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    
\PY{k}{def} \PY{n+nf}{plotter}\PY{p}{(}\PY{n}{dummy}\PY{p}{,} \PY{n}{logreg}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{dataset\PYZus{}title}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    V0.0}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{y\PYZus{}pred\PYZus{}dummy} \PY{o}{=} \PY{n}{dummy}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{y\PYZus{}pred\PYZus{}logreg} \PY{o}{=} \PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
    \PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{16}\PY{p}{)}\PY{p}{)}
    \PY{n}{ax} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
    \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DummyClassifier}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{dummy}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}
                                        \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{values\PYZus{}format}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Blues}\PY{p}{)}
    \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogisticRegression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{logreg}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,}
                                        \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{values\PYZus{}format}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                        \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Blues}\PY{p}{)}
    \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ROC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{(}\PY{n}{dummy}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
    \PY{n}{plot\PYZus{}roc\PYZus{}curve}\PY{p}{(}\PY{n}{logreg}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}conf\PYZus{}mat\PYZus{}disp.ax\PYZus{}.set\PYZus{}title(\PYZdq{}Dummy Classifier (strategy=\PYZsq{}most\PYZus{}frequent\PYZsq{})\PYZdq{})}
    \PY{c+c1}{\PYZsh{}roc\PYZus{}disp.ax\PYZus{}.set\PYZus{}title(\PYZdq{}ROC\PYZdq{})}


    \PY{n}{mets} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{dummy}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{,} \PY{n}{logreg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{]}\PY{p}{,}
          \PY{p}{[}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dummy}\PY{p}{)}\PY{p}{,}
           \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}logreg}\PY{p}{)}\PY{p}{]}\PY{p}{,}
          \PY{p}{[}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dummy}\PY{p}{)}\PY{p}{,}
           \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}logreg}\PY{p}{)}\PY{p}{]}\PY{p}{,}
          \PY{p}{[}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dummy}\PY{p}{)}\PY{p}{,}
           \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}logreg}\PY{p}{)}\PY{p}{]}\PY{p}{,}
          \PY{p}{[}\PY{n}{matthews\PYZus{}corrcoef}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dummy}\PY{p}{)}\PY{p}{,}
           \PY{n}{matthews\PYZus{}corrcoef}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}logreg}\PY{p}{)}\PY{p}{]}\PY{p}{]}
    \PY{n}{table\PYZus{}cells} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}j:.2f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{mets}\PY{p}{]}
    \PY{n}{table\PYZus{}cells}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{table\PYZus{}cells}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{N.D}\PY{l+s+s2}{\PYZdq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{table\PYZus{}cells}\PY{p}{)}

    \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}axis\PYZus{}off}\PY{p}{(}\PY{p}{)}
    \PY{n}{table} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{table}\PY{p}{(}
      \PY{n}{cellText} \PY{o}{=} \PY{n}{table\PYZus{}cells}\PY{p}{,}
      \PY{n}{rowLabels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precison}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1 Score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MCC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
      \PY{n}{colLabels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DummyClassifier}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{LogisticRegression}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
      \PY{n}{rowColours} \PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{skyblue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{5}\PY{p}{,}
      \PY{n}{colColours} \PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{skyblue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{2}\PY{p}{,}
      \PY{n}{cellLoc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
      \PY{n}{loc} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}
    \PY{p}{)}
    \PY{n}{table}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
    \PY{n}{table}\PY{o}{.}\PY{n}{scale}\PY{p}{(}\PY{l+m+mf}{1.1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Evaluation Metrices for }\PY{l+s+si}{\PYZob{}dataset\PYZus{}title\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{n}{dataset\PYZus{}title}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

    
    
\PY{k}{def} \PY{n+nf}{test\PYZus{}models}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{f\PYZus{}list}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    V0.0}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{}dummy\PYZus{}first\PYZus{}plot = True}
    
    \PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{sharey}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
    
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{f} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{f\PYZus{}list}\PY{p}{)}\PY{p}{:}
        \PY{n}{X} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{n}{f}\PY{p}{]}
        \PY{n}{y} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diab}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
        \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{n}{test\PYZus{}size}\PY{p}{,} 
                                                      \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{random\PYZus{}state}\PY{p}{)}
        
        
        \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{c+c1}{\PYZsh{}All dummy Classifier metrices are going to be same for splits with same random\PYZus{}state }
            \PY{n}{dummy} \PY{o}{=} \PY{n}{DummyClassifier}\PY{p}{(}\PY{n}{strategy}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{most\PYZus{}frequent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{dummy}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
            \PY{n}{y\PYZus{}pred\PYZus{}dummy} \PY{o}{=} \PY{n}{dummy}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
            \PY{n}{cfm} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}dummy}\PY{p}{)}
            \PY{n}{cfm\PYZus{}disp} \PY{o}{=} \PY{n}{ConfusionMatrixDisplay}\PY{p}{(}\PY{n}{cfm}\PY{p}{)}
            \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
            \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{ax\PYZus{}}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DummyClassifier}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{im\PYZus{}}\PY{o}{.}\PY{n}{colorbar}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{p}{)}
            \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{ax\PYZus{}}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                   
        \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{ax\PYZus{}}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            
        \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{)}
        \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
        \PY{n}{y\PYZus{}pred\PYZus{}logreg} \PY{o}{=} \PY{n}{logreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
        \PY{n}{cfm} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}logreg}\PY{p}{)}
        \PY{n}{cfm\PYZus{}disp} \PY{o}{=} \PY{n}{ConfusionMatrixDisplay}\PY{p}{(}\PY{n}{cfm}\PY{p}{)}
        \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}cfm\PYZus{}disp.ax\PYZus{}.set\PYZus{}title(\PYZdq{}DummyClassifier\PYZdq{})}
        \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{im\PYZus{}}\PY{o}{.}\PY{n}{colorbar}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{p}{)}
        \PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{ax\PYZus{}}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
    \PY{n}{fig}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.4}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ha}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.45}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ha}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,} \PY{n}{rotation\PYZus{}mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{anchor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.40}\PY{p}{,} \PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{cfm\PYZus{}disp}\PY{o}{.}\PY{n}{im\PYZus{}}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axs}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
<tex2html_mydb_mark>#97#[commandchars=\\\{\}]